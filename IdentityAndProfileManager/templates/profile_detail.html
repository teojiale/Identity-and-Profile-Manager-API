<!--  profile_detail.html-->
{% extends 'base.html' %}

{% block title %}{{ username }}'s Profile{% endblock %}

{% block main_classes %}pt-16{% endblock %}

{% block content %}
  <header class="relative isolate">
    <div class="absolute inset-0 -z-10 overflow-hidden" aria-hidden="true">
      <div class="absolute top-full left-16 -mt-16 transform-gpu opacity-50 blur-3xl xl:left-1/2 xl:-ml-80">
        <div class="aspect-1154/678 w-[72.125rem] bg-linear-to-br from-[#FF80B5] to-[#9089FC]" style="clip-path: polygon(100% 38.5%, 82.6% 100%, 60.2% 37.7%, 52.4% 32.1%, 47.5% 41.8%, 45.2% 65.6%, 27.5% 23.4%, 0.1% 35.3%, 17.9% 0%, 27.7% 23.4%, 76.2% 2.5%, 74.2% 56%, 100% 38.5%)"></div>
      </div>
      <div class="absolute inset-x-0 bottom-0 h-px bg-gray-900/5"></div>
    </div>

    <div class="mx-auto max-w-7xl px-4 py-10 sm:px-6 lg:px-8">
      <div class="mx-auto flex max-w-2xl items-center justify-center gap-x-8 lg:mx-0 lg:max-w-none flex-col">
        <div class="flex items-center gap-x-6 flex-col">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"  class="size-16 flex-none rounded-full ring-1 ring-gray-900/10 p-2 fill-white bg-indigo-600">
            <path fill-rule="evenodd" d="M7.5 6a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM3.751 20.105a8.25 8.25 0 0 1 16.498 0 .75.75 0 0 1-.437.695A18.683 18.683 0 0 1 12 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 0 1-.437-.695Z" clip-rule="evenodd" />
          </svg>

          <h1 class="mt-2 flex items-center gap-x-2">
            <div class="text-lg sm:text-xl font-bold text-gray-900 tracking-tight">{{ username }}</div>
            {% if is_owner %}
              <a href="{% url 'profile_edit' %}" class="rounded-full bg-indigo-100 text-indigo-700 hover:bg-indigo-200 transition-all duration-300">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-3 m-1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125" />
                </svg>
              </a>
            {% endif %}
          </h1>
        </div>

      </div>
    </div>
  </header>


  <div class="mx-auto max-w-7xl px-4 py-16 sm:px-6 lg:px-8">
    <div class="mx-auto grid max-w-2xl grid-cols-1 grid-rows-1 items-start gap-x-8 gap-y-8 lg:mx-0 lg:max-w-none lg:grid-cols-3">
      <!-- Basic Information Section -->
      <div class="lg:col-start-3 lg:row-end-1 bg-white rounded-lg sm:ring-1 sm:shadow-xs sm:ring-gray-900/5 sm:p-6">
        <div>
          <h3 class="text-base/7 font-semibold text-gray-900">Names</h3>
          <p class="mt-1 max-w-2xl text-sm/6 text-gray-500">Various names and their visibility settings.</p>
        </div>
        <div class="mt-6">
          <div class="divide-y divide-gray-100">
            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Legal Name</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.legal_name %}
                  {{ visible_fields.legal_name }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>

            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Birth Name</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.birth_name %}
                  {{ visible_fields.birth_name }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>

            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Native Name</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.native_name %}
                  {{ visible_fields.native_name }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>
          </div>
        </div>
      </div>

      <!-- Names Section -->
      <div class="bg-white rounded-lg -mx-4 px-4 py-8 ring-1 shadow-xs ring-gray-900/5 sm:mx-0 sm:rounded-lg sm:px-8 sm:pb-14 lg:col-span-2 lg:row-span-2 lg:row-end-2 xl:px-16 xl:pt-16 xl:pb-20">
        <div>
          <h3 class="text-base/7 font-semibold text-gray-900">Basic Information</h3>
          <p class="mt-1 max-w-2xl text-sm/6 text-gray-500">Basic personal information.</p>
        </div>
        <div class="mt-6">
          <div class="divide-y divide-gray-100">
            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Email</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.email %}
                  {{ visible_fields.email }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>

            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Occupation</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.occupation %}
                  {{ visible_fields.occupation }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>

            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Age</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.age %}
                  {{ visible_fields.age }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>

            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Gender Identity</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.gender_identity %}
                  {{ visible_fields.gender_identity }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>

            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-sm font-medium text-gray-900">Pronoun</dt>
              <dd class="mt-1 text-sm/6 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.pronoun %}
                  {{ visible_fields.pronoun }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>
          </div>
        </div>
      </div>

      <!-- Contact Information Section -->
      <div class="lg:col-start-3">
        <div class="mt-4">
          <h3 class="text-sm/6 font-semibold text-gray-900 pb-2">Contact Information</h3>
          <div class="divide-y divide-gray-100">
            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0">
              <dt class="text-xs font-medium text-gray-900">Home Address</dt>
              <dd class="mt-1 text-xs/5 text-gray-700 sm:col-span-2 sm:mt-0">
                {% if visible_fields.home_address %}
                  {{ visible_fields.home_address|linebreaks }}
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>

            <div class="py-6 sm:grid sm:grid-cols-3 sm:gap-4 px-0 items-center">
              <dt class="text-xs font-medium text-gray-900">Emergency Contact</dt>
              <dd class="mt-2 text-xs text-gray-900 sm:col-span-2 sm:mt-0">
                {% if visible_fields.emergency_contact %}
                  <ul role="list" class="divide-y divide-gray-100 rounded-md border border-gray-200">
                    <li class="flex items-center justify-between py-2 pr-3 pl-2 text-xs/5">
                      <div class="flex w-0 flex-1 items-center">
                        <svg class="size-5 shrink-0 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z" />
                        </svg>
                        <div class="ml-4 flex min-w-0 flex-1 gap-2">
                          <span class="truncate font-medium">{{ visible_fields.emergency_contact }}</span>
                          {% if profile.phone_number %}
                            <span class="shrink-0 text-gray-400">{{ profile.phone_number }}</span>
                          {% endif %}
                        </div>
                      </div>
                      <div class="ml-4 shrink-0">
                        <button type="button" id="copy-emergency-btn" class="cursor-pointer font-medium text-indigo-600 hover:text-indigo-500"
                        onclick="copyToClipboard('{{ visible_fields.emergency_contact }}')"
                        >Copy</button>
                      </div>
                    </li>
                  </ul>
                {% else %}
                  <span class="text-gray-400 italic flex items-center gap-x-2">
                    Private information
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                    </svg>
                  </span>
                {% endif %}
              </dd>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% block scripts %}
  <script>
    if (typeof window.copyTimeout === 'undefined') {
      window.copyTimeout = null;
    }
    if (typeof window.isCopying === 'undefined') {
      window.isCopying = false;
    }

    function copyToClipboard(text) {
      // Prevent multiple rapid clicks
      if (window.isCopying) {
        return;
      }

      // Clear any existing timeout
      if (window.copyTimeout) {
        clearTimeout(window.copyTimeout);
      }

      window.isCopying = true;
      const button = document.getElementById('copy-emergency-btn');

      // Copy text to clipboard
      navigator.clipboard.writeText(text).then(function() {
        showCheckIcon(button);
      }).catch(function(err) {
        console.error('Failed to copy: ', err);
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        try {
          document.execCommand('copy');
          showCheckIcon(button);
        } catch (fallbackErr) {
          console.error('Fallback copy failed: ', fallbackErr);
          window.isCopying = false;
        }
        document.body.removeChild(textArea);
      });
    }

    function showCheckIcon(button) {
      // Change button content to check icon
      button.innerHTML = `
        <svg class="w-4 h-4 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
      `;

      // Revert back to "Copy" text after 2 seconds
      window.copyTimeout = setTimeout(function() {
        button.innerHTML = 'Copy';
        window.isCopying = false;
        window.copyTimeout = null;
      }, 2000);
    }
  </script>
  {% endblock %}
{% endblock %}